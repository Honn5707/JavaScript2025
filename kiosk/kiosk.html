<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="kiosk.css">
    <title>cafekiosk</title>
    
</head>
<body>
    <div class="wrap">
      <div class="order_menu">
        <h2>원하시는 음료를 선택해 주세요</h2>
        <p>Please choose the drink you want.</p>
        <div class="section1">
          <h2>MENU</h2>
          <div class="menubox"></div>
        </div>
    </div>

    <div class="section2">
          <h2>주문내역</h2>
          <div class="orderbox"></div>
          <div class="order_result">
            <h2>총 주문금액 : <span class="pay"></span></h2>
            <span class="line"></span>
            <button class="btn">현금결제</button>
        </div>
    </div>
      
    </div>
    
    <!-- 스크립트 -->
    <script>
        const pay = document.querySelector(`.pay`);
        const menubox = document.querySelector(`.menubox`);
        const orderbox = document.querySelector(`.orderbox`);



        let menus = [
        { id:0, name: '아메리카노', type: 'HOT', price: 1000,quantity:0 },
        { id:1, name: '아메리카노', type: 'ICE', price: 1300,quantity:0 },
        { id:2, name: '바닐라라떼', type: 'HOT', price: 2500,quantity:0 },
        { id:3, name: '바닐라라떼', type: 'ICE', price: 2800,quantity:0},
        { id:4, name: '연유라떼', type: 'HOT', price: 2500,quantity:0 },
        { id:5, name: '연유라떼', type: 'ICE', price: 2800,quantity:0 },
        { id:6, name: '카라멜마끼아또', type: 'HOT', price: 2800,quantity:0 },
        { id:7, name: '카라멜마끼아또', type: 'ICE', price: 3000,quantity:0 },
        { id:8, name: '카페모카', type: 'HOT', price: 3000,quantity:0 },
        { id:9, name: '카페모카', type: 'ICE', price: 3300,quantity:0 },
        { id:10, name: '딥카페라테', type: 'HOT', price: 3400,quantity:0 },
        { id:11, name: '딥카페라테', type: 'ICE', price: 3700,quantity:0 },
        ];
        let cart = new Array();
        let priceCount = 0;


        function Menuboard(){
        let result = '';


        for(let i=0; i<menus.length; i++){
            //버튼생성
            result += `<button class="menu" onclick = "Priceadd(${i})">`;
            //온도 출력
            result += `<span class ="menu_type">${menus[i].type}</span>`;
            //이미지 출력
            result += menus[i].type == "ICE" ? `<img src = "image/ice.png"></img>` :  `<img src = "image/hot.png"></img>`;
            //이름 출력
            result += `<span class="menu_name"><br>${menus[i].name}(${menus[i].type})</span>`
            //가격 출력
            result += `<span class="menu_price"><br>${menus[i].price}원</span>`
        }

        menubox.innerHTML = result;
        
    }

    function Priceadd(priceIndex){
        if(menus[priceIndex].quantity == 0){
            if(priceCount >=6) alert('최대 주문은 6건 까지 가능합니다!');
            else{
            cart[priceCount] = menus[priceIndex].id;
            priceCount++;
        }
        }
        
        if(menus[priceIndex].quantity < 10 ){
        menus[priceIndex].quantity++;
        pricelist();
        }else alert('음료 최대 주문은 10잔 입니다.');
    }
    function Pricereduce(priceIndex){
        if(menus[priceIndex].quantity > 1)menus[priceIndex].quantity--;
        else{
             menus[priceIndex].quantity = 0;
             priceCount--;
             let idx = cart.indexOf(menus[priceIndex].id);
            
                cart.splice(idx, 1); 
            

             console.log(cart);
             console.log(priceCount);
        }
        pricelist();
    }
    function Pricedelete(priceIndex){
        menus[priceIndex].quantity = 0;
        priceCount--;
        let idx = cart.indexOf(menus[priceIndex].id);
        if (idx !== -1) {
        cart.splice(idx, 1); // 그 ID가 있는 위치에서 1개 삭제
        }

        console.log(cart);
        console.log(priceCount);
        pricelist();
    }

    //상품 목록

    function pricelist(){
        let result = '';
        let total = 0;
        for(let i = 0; i<priceCount; i++){

            let imPrice = new Object(menus[cart[i]]);
        
                total += imPrice.price*imPrice.quantity;
                result += `<div class = "hold_price">`
                    //이름
                result += `${imPrice.name}(${imPrice.type}): `;
                    //수량
                result += `${imPrice.quantity}개: `;
                    //가격
                result += `${(imPrice.price*imPrice.quantity).toLocaleString('ko-kr')}원 <br>`;
                    //하단 버튼
                result += `<div><button class = "list_plus" onclick ="Priceadd(${cart[i]})">+</button>
                            <button class = "list_minus" onclick ="Pricereduce(${cart[i]})">-</button><button class = "list_delete" onclick ="Pricedelete(${cart[i]})">선택취소</button>
                            </div>`
                result += `</div>`
                
                        
            

           
        }
         orderbox.innerHTML = result;
        pay.innerHTML = total +'원';
        // for(let i = 0; i<menus.length; i++){
        //     menus[i].quantity = 0;
        // }
    }

        

    Menuboard();

    </script>
</body>
</html>